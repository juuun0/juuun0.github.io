---
title: NSPredicate exploit on iOS and macOS
category: Blog
tags: ['iOS N-day Exploit', 'Conference']
date: 2024-11-01 18:00:00 +0900
author: insp3ct0r_x
---

# 0x01. Intro

The `NSPredicate` is mentioned in iMessage 0-click exploit chain a.k.a. **FORCEDENTRY**. This exploit is triggered by PDF files disguised as GIF files in JBIG2 image codec and NSPredicated used to sandbox escape.

> This post is based on the [Black Hat USA 2023 Presentation](https://www.youtube.com/watch?v=jZj8EEBp8xE)! You can watch the full video on their YouTube.
{: .prompt-info}

# 0x02. Background Knowledge

## a. selector & KeyPath

We have to know the **selector** and the **KeyPath** which is part of the Objective-C's features to understand how vulnerability is works.

### selector

According to the [Documents](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocSelectors.html), *selector* has two meanings in Objective-C:

> It can be used to refer simply to the name of a method when itâ€™s used in a source-code message to an object. It also, though, refers to the unique identifier that replaces the name when the source code is compiled.

In the source-code, selector just 

---

# 0xFF. References

- [Apple Developer Documents - Selectors](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocSelectors.html)
